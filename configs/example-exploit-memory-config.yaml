# Example Exploit Memory Configuration
# Demonstrates how to configure the exploit memory database system

authentication:
  login_type: form
  login_url: https://example.com/login
  credentials:
    username: testuser@example.com
    password: TestPassword123
  success_condition:
    type: url_contains
    value: /dashboard
  login_flow:
    - Navigate to the login page
    - Enter $username in the email field
    - Enter $password in the password field
    - Click the login button
    - Wait for redirect to dashboard

# Exploit Memory Configuration
exploit_memory:
  # Enable exploit memory database (default: true)
  enabled: true

  # Deduplication strategy for vulnerabilities
  # - strict: Exact match on hostname + type + source + path + sink (recommended)
  # - loose: Match only on hostname + type + path (more duplicates, faster)
  # - both: Check both strategies for maximum coverage
  deduplication_strategy: strict

  # Maximum age in days for historical vulnerabilities to include
  # Older vulnerabilities are excluded from prompt context but kept in database
  max_age_days: 90

  # Automatically trigger infrastructure testing when credentials are discovered
  # Set to false to require manual phase execution
  trigger_infrastructure: true

# Optional: Testing rules
rules:
  avoid:
    - description: Do not test production payment endpoints
      type: path
      url_path: /api/payments/charge
  focus:
    - description: Focus on admin panel vulnerabilities
      type: path
      url_path: /admin

# Optional: Model configuration for cost optimization
# Using Sonnet 4.5 for all phases (Haiku 4.5 not yet available)
models:
  analysis: claude-sonnet-4-5-20250929
  exploitation: claude-sonnet-4-5-20250929
  reporting: claude-sonnet-4-5-20250929
